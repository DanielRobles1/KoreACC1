<button class="fixed top-4 left-4 z-50 bg-blue-100 border rounded p-2 shadow-md"
        type="button"
        (click)="toggleSidebar()">
  <svg *ngIf="!open" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6"
       fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M4 6h16M4 12h16M4 18h16" />
  </svg>
  <svg *ngIf="open" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6"
       fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M6 18L18 6M6 6l12 12" />
  </svg>
</button>

<div class="sidebar-shell h-full bg-white text-gray-800 p-0 shadow-md border-r border-gray-200">
  <div class="p-4">
    <div class="mb-4 flex flex-col items-center text-center">
      <img src="assets/svgs/Kore-ACC.svg" alt="Logo" class="h-28 w-auto">
      <h2 class="text-lg font-bold mb-4 text-center">KORE ACC</h2>

      <div *ngIf="user" class="mt-2">
        <p class="text-lg font-extrabold cursor-pointer" (click)="openEditProfile()">{{ user.nombre }}</p>
      </div>

      <app-edit-profile-modal
        [open]="editProfileOpen"
        [user]="user"
        (closed)="closeEditProfile()"
        (saved)="saveProfile($event)">
      </app-edit-profile-modal>
    </div>

    <!-- Menú -->
    <ul class="space-y-2">
      <li>
        <button type="button"
                class="btn"
                [class.btn--active]="active==='polizas'"
                (click)="setActive('polizas')">
          <img src="assets/svgs/poliza.svg" alt="Pólizas" class="icon">
          <span class="ml-2">Pólizas</span>
        </button>
      </li>

      <li>
        <button type="button"
                class="btn"
                [class.btn--active]="active==='reportes'"
                (click)="toggleReportes()">
          <img src="assets/svgs/reportes.svg" alt="Reportes" class="icon">
          <span class="ml-2 flex-1 text-left">Reportes</span>
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4 caret transition-transform"
               [class.rotate-180]="reportesOpen"
               fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 9l-7 7-7-7" />
          </svg>
        </button>

        <ul class="mt-2 space-y-1 pl-10" *ngIf="reportesOpen">
          <li><a href="#" class="subbtn flex items-center">
            <img src="assets/svgs/reporte-opciones.svg" class="icon-sm" alt="Balance general">
            <span class="ml-2">Balance general</span>
          </a></li>
          <li><a href="#" class="subbtn flex items-center">
            <img src="assets/svgs/reporte-opciones.svg" class="icon-sm" alt="Balanza de comprobacion">
            <span class="ml-2">Balanza de comprobacion</span>
          </a></li>
          <li><a href="#" class="subbtn flex items-center">
            <img src="assets/svgs/reporte-opciones.svg" class="icon-sm" alt="Estado de resultados">
            <span class="ml-2">Estado de resultados</span>
          </a></li>
        </ul>
      </li>

      <li>
        <button type="button"
                class="btn"
                [class.btn--active]="active==='dashboard'"
                (click)="setActive('dashboard')">
          <img src="assets/svgs/dashboard.svg" alt="Dashboard" class="icon">
          <span class="ml-2">Dashboard</span>
        </button>
      </li>
    </ul>
  </div>

  <!-- Configuración -->
  <div class="px-4 mt-auto">
    <button type="button"
            class="btn w-full"
            [class.btn--active]="active==='configuracion'"
            (click)="toggleConfiguracion()">
      <span>⚙️</span>
      <span class="ml-2 flex-1 text-left">Configuración</span>
      <svg xmlns="http://www.w3.org/2000/svg"
           class="h-4 w-4 caret transition-transform"
           [class.rotate-180]="configOpen"
           fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M19 9l-7 7-7-7" />
      </svg>
    </button>

    <ul class="mt-2 space-y-1 pl-10" *ngIf="configOpen">

      <!-- Usuarios / Permisos -->
      <li>
        <button type="button"
                class="btn"
                [class.btn--active]="active==='usuarios-permisos'"
                (click)="toggleUsuariosPermisos()">
          <span>👤</span>
          <span class="ml-2 flex-1 text-left">Usuarios / Permisos</span>
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4 caret transition-transform"
               [class.rotate-180]="usuariosPermisosOpen"
               fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 9l-7 7-7-7" />
          </svg>
        </button>

        <ul class="mt-2 space-y-1 pl-10" *ngIf="usuariosPermisosOpen">
          <li><a [routerLink]="['/usuarios']" class="subbtn flex items-center" (click)="setActive('usuarios-permisos')">
            <img src="assets/svgs/usuarios.svg" class="icon-sm" alt="Usuarios">
            <span class="ml-2">Usuarios</span>
          </a></li>
          <li><a [routerLink]="['/roles']" class="subbtn flex items-center" (click)="setActive('usuarios-permisos')">
            <img src="assets/svgs/roles.svg" class="icon-sm" alt="Permisos">
            <span class="ml-2">Permisos</span>
          </a></li>
        </ul>
      </li>

      <!-- Catálogos -->
      <li>
        <button type="button"
                class="btn"
                [class.btn--active]="active==='catalogos'"
                (click)="toggleCatalogos()">
          <span>📚</span>
          <span class="ml-2 flex-1 text-left">Catálogos</span>
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4 caret transition-transform"
               [class.rotate-180]="catalogosOpen"
               fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 9l-7 7-7-7" />
          </svg>
        </button>

        <ul class="mt-2 space-y-1 pl-10" *ngIf="catalogosOpen">
          <li><a [routerLink]="['/catalogos/cuentas']" class="subbtn flex items-center" (click)="setActive('catalogos')">
            <img src="assets/svgs/cuentas.svg" class="icon-sm" alt="Cuentas">
            <span class="ml-2">Cuentas</span>
          </a></li>
          <li><a [routerLink]="['/catalogos/cc']" class="subbtn flex items-center" (click)="setActive('catalogos')">
            <img src="assets/svgs/cc.svg" class="icon-sm" alt="Centros de costo">
            <span class="ml-2">Centros de costo</span>
          </a></li>
        </ul>
      </li>

      <!-- Empresa / Periodos -->
      <li>
        <button type="button"
                class="btn"
                [class.btn--active]="active==='empresa'"
                (click)="toggleEmpresa()">
          <span>🏢</span>
          <span class="ml-2 flex-1 text-left">Empresa / Periodos</span>
          <svg xmlns="http://www.w3.org/2000/svg"
               class="h-4 w-4 caret transition-transform"
               [class.rotate-180]="empresaOpen"
               fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 9l-7 7-7-7" />
          </svg>
        </button>

        <ul class="mt-2 space-y-1 pl-10" *ngIf="empresaOpen">
          <li><a [routerLink]="['/empresa']" class="subbtn flex items-center" (click)="setActive('empresa')">
            <img src="assets/svgs/empresa.svg" class="icon-sm" alt="Empresa">
            <span class="ml-2">Empresa</span>
          </a></li>
          <li><a [routerLink]="['/periodos']" class="subbtn flex items-center" (click)="setActive('empresa')">
            <img src="assets/svgs/periodos.svg" class="icon-sm" alt="Periodos">
            <span class="ml-2">Periodos</span>
          </a></li>
        </ul>
      </li>

      <!-- Cerrar sesión -->
      <li>
        <button type="button" class="subbtn text-red-600 flex items-center" (click)="openLogoutConfirm()">
          🚪 <span class="ml-2">Cerrar sesión</span>
        </button>
      </li>
    </ul>
  </div>

  <!-- Modal confirmación -->
  <app-modal
    [open]="confirmOpen"
    [title]="confirmTitle"
    size="sm"
    (closed)="closeConfirm()"
    (canceled)="cancelConfirm()"
    (confirmed)="confirmProceed()">
    <p class="mb-2">{{ confirmMessage }}</p>
  </app-modal>
</div>