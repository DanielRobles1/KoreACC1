<!-- colapsar -->
<button
  class="sidebar-toggle"
  type="button"
  (click)="toggleSidebar()"
  [attr.aria-label]="open ? 'Contraer menú' : 'Expandir menú'"
  [attr.aria-expanded]="open"
>
  <svg
    *ngIf="open"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    width="22"
    height="22"
  >
    <polyline points="15 18 9 12 15 6"></polyline>
  </svg>

  <svg
    *ngIf="!open"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
    width="22"
    height="22"
  >
    <polyline points="9 6 15 12 9 18"></polyline>
  </svg>
</button>

<div class="sidebar-shell">

  <!-- HEADER -->
  <div class="sidebar-header">

    <div class="logo-section">
      <img src="assets/svgs/Kore-ACC.svg" class="logo-img" />
      <h2 class="logo-title">Kore ACC</h2>
    </div>

    <div *ngIf="user" class="user-section">
      <p class="user-name" (click)="openEditProfile()">
        {{ user.nombre }}
      </p>
    </div>

    <app-edit-profile-modal
      [open]="editProfileOpen"
      [user]="tempUser"
      (closed)="closeEditProfile()"
      (saved)="saveProfile($event)"
    ></app-edit-profile-modal>

  </div>

  
  <div class="sidebar-content">

    <nav class="main-nav">

      <!-- POLIZAS -->
      <div class="nav-item">
        <button
          class="btn"
          routerLink="/poliza-home"
          routerLinkActive="btn--active"
          [routerLinkActiveOptions]="{ exact: true }"
        >
          <img src="assets/svgs/poliza.svg" class="icon" />
          <span class="btn-text">Pólizas</span>
        </button>
      </div>

      <!-- REPORTES -->
      <div class="nav-item">

        <button
          class="btn"
          [class.btn--active]="reportesOpen"
          (click)="toggleReportes()"
        >
          <img src="assets/svgs/reportes.svg" class="icon" />
          <span class="btn-text">Reportes</span>

          <svg
            class="caret"
            [class.caret--open]="reportesOpen"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            />
          </svg>
        </button>

        <ul class="submenu" *ngIf="reportesOpen">

          <li>
             
            <a
              routerLink="/balance-general"
              routerLinkActive="subbtn--active"
              class="subbtn"
            >
              Balance general
            </a>
          </li>

          <li>
            <a
              routerLink="/balanza-comprobacion"
              routerLinkActive="subbtn--active"
              class="subbtn"
            >            

              Balanza de comprobación
            </a>
          </li>

          <li>
            <a
              routerLink="/estado-resultados"
              routerLinkActive="subbtn--active"
              class="subbtn"
            >
              Estado de resultados
            </a>
          </li>

        </ul>
      </div>

      <!-- DASHBOARD -->
      <div class="nav-item">
        <button
          class="btn"
          routerLink="/dashboard-contable"
          routerLinkActive="btn--active"
        >
          <img src="assets/svgs/dashboard.svg" class="icon" />
          <span class="btn-text">Dashboard</span>
        </button>
      </div>

      <div class="nav-divider"></div>

      <!-- CONFIGURACION -->
<div class="nav-item">

  <!-- BOTÓN PRINCIPAL -->
  <button
    class="btn"
    [class.btn--active]="configOpen"
    (click)="toggleConfiguracion()"
  >

    <!-- ICONO CONFIG -->
<img src="assets/svgs/settings.svg" class="icon" />


    <span class="btn-text">Configuración</span>

    
    <svg
      class="caret"
      [class.caret--open]="configOpen"
      fill="none"
      viewBox="0 0 24 24"
      stroke="currentColor"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M19 9l-7 7-7-7"
      />
    </svg>

  </button>


  <!-- SUBMENÚ -->
  <ul class="submenu" *ngIf="configOpen">


    <!-- USUARIOS -->
    <li>

      <button
        class="btn btn--sub"
        [class.btn--active]="usuariosPermisosOpen"
        (click)="toggleUsuariosPermisos()"
      >

        <!-- ICONO USUARIOS -->
        <svg
          class="icon icon--sm"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M17 20h5v-2a4 4 0 00-4-4h-1m-4 6H2v-2a4 4 0 014-4h1m4-4a4 4 0 100-8 4 4 0 000 8zm6 4a4 4 0 100-8 4 4 0 000 8z"
          />
        </svg>

        <span class="btn-text">Usuarios / Permisos</span>

        <svg
          class="caret caret--sm"
          [class.caret--open]="usuariosPermisosOpen"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>

      </button>


      <ul class="submenu submenu--nested" *ngIf="usuariosPermisosOpen">

        <li>
          <a
            routerLink="/usuarios"
            routerLinkActive="subbtn--active"
            class="subbtn"
          >
            Usuarios
          </a>
        </li>

        <li>
          <a
            routerLink="/login/roles"
            routerLinkActive="subbtn--active"
            class="subbtn"
          >
            Permisos
          </a>
        </li>

      </ul>

    </li>


    <!-- CATALOGOS -->
    <li>

      <button
        class="btn btn--sub"
        [class.btn--active]="catalogosOpen"
        (click)="toggleCatalogos()"
      >

        <!-- ICONO CATALOGOS -->
        <svg
          class="icon icon--sm"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M4 6h16M4 12h16M4 18h16"
          />
        </svg>

        <span class="btn-text">Catálogos</span>

        <svg
          class="caret caret--sm"
          [class.caret--open]="catalogosOpen"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>

      </button>


      <ul class="submenu submenu--nested" *ngIf="catalogosOpen">

        <li>
          <a
            routerLink="/catalogos/cuentas"
            routerLinkActive="subbtn--active"
            class="subbtn"
          >
            Cuentas
          </a>
        </li>

        <li>
          <a
            routerLink="/centros-costo"
            routerLinkActive="subbtn--active"
            class="subbtn"
          >
            Centros de costo
          </a>
        </li>

      </ul>

    </li>


    <!-- EMPRESA -->
    <li>

      <button
        class="btn btn--sub"
        [class.btn--active]="empresaOpen"
        (click)="toggleEmpresa()"
      >

        <!-- ICONO EMPRESA -->
        <svg
          class="icon icon--sm"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          stroke-width="2"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3 21h18M4 21V7l8-4 8 4v14M9 21v-6h6v6"
          />
        </svg>

        <span class="btn-text">Empresa</span>

        <svg
          class="caret caret--sm"
          [class.caret--open]="empresaOpen"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M19 9l-7 7-7-7"
          />
        </svg>

      </button>


      <ul class="submenu submenu--nested" *ngIf="empresaOpen">

        <li>
          <a
            routerLink="/empresa"
            routerLinkActive="subbtn--active"
            class="subbtn"
          >
            Periodos
          </a>
        </li>

        <li>
          <a
            routerLink="/empresas"
            routerLinkActive="subbtn--active"
            class="subbtn"
          >
            Empresa
          </a>
        </li>
<li>
          <a
            routerLink="/empresas"
            routerLinkActive="subbtn--active"
            class="subbtn"
            routerLink="/tipopoliza" routerLinkActive="active"
          >
            Tipo de póliza
          </a>
        </li>
      </ul>

    </li>

  </ul>

</div>
 <!-- Footer -->
  <div class="sidebar-footer">
    <button
      type="button"
      class="btn btn--logout"
      (click)="openLogoutConfirm()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="icon"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
        />
      </svg>
      <span class="btn-text">Cerrar sesión</span>
    </button>
  </div>

  <!-- Modal confirmación -->
  <app-modal
    [open]="confirmOpen"
    [title]="confirmTitle"
    size="sm"
    (closed)="closeConfirm()"
    (canceled)="cancelConfirm()"
    (confirmed)="confirmProceed()"
  >
    <p class="mb-2">{{ confirmMessage }}</p>
  </app-modal>
  